"use strict";angular.module("cfgUiApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/review",{templateUrl:"views/review.html",controller:"ReviewCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("cfgUiApp").controller("MainCtrl",["$scope","$compile","$route","$modal","Context","User","Chs","Guess",function(a,b,c,d,e,f,g,h){var i=window.$,j=function(){for(var c in a.context.sentences){var d=a.context.sentences[c],e=a.context.sentences[c].sentence.id,f="#sentence"+e,g=".sentence"+e,h=b("<h5>"+d.cost+' monies</h5><a class="btn" ng-click="buy(\''+f+"', "+e+')">Buy</a>')(a);console.log(g),i(g).popover({html:!0,title:"Buy Context",placement:"top",content:h,trigger:"hover click"})}};a.user=f.get(),a.context=e.new(null,j);var k=function(b){for(var c in a.context.sentences)if(a.context.sentences[c].sentence.id===b)return a.context.sentences[c];return void 0};a.buy=function(b,c){var e=k(c);e.$update(null,function(){a.user.monies-=e.cost,i(b).popover("hide"),i(b).popover("disable")},function(a){i(b).popover("hide"),403===a.status&&d.open({templateUrl:"views/needmoniesmodal.html",controller:"NeedmoniesCtrl"})})},a.makeGuess=function(){var b=new h({context:a.context,guess:a.guess});b.$save(),a.next()},a.next=function(){c.reload()},a.makeReview=function(){d.open({templateUrl:"views/review.html",controller:"ReviewCtrl"}),a.user=f.get()},a.click=function(c,d){var e=k(d);if(!e.visible){var f=b("<h5>"+e.cost+' monies</h5><a class="btn" ng-click="buy(\''+c+"', "+d+')">Buy</a>')(a);i(c).popover({html:!0,title:"Buy Context",placement:"top",content:f}),i(c).popover("show")}}}]),angular.module("cfgUiApp").service("Context",["$resource","Chs",function(a,b){var c=window.config;return a(c.routes.context,null,{"new":{method:"GET",url:c.routes.contextNew,transformResponse:function(a){a=JSON.parse(a);for(var c=0;c<a.sentences.length;c++)a.sentences[c]=new b(a.sentences[c]);return a}}})}]),angular.module("cfgUiApp").service("User",["$resource",function(a){var b=window.config;return a(b.routes.user,null,{get:{method:"GET",isArray:!1}})}]),angular.module("cfgUiApp").service("Chs",["$resource",function(a){var b=window.config;return a(b.routes.chs,{id:"@id"},{update:{method:"PUT"}})}]),angular.module("cfgUiApp").service("Guess",["$resource",function(a){var b=window.config;return a(b.routes.guess,{id:"@id"},{update:{method:"PUT"}})}]),angular.module("cfgUiApp").controller("NeedmoniesCtrl",["$scope","$modalInstance",function(a,b){a.close=function(){b.close()}}]),angular.module("cfgUiApp").controller("ReviewCtrl",["$scope","$modalInstance","Review",function(a,b,c){a.review=c.new(),a.submit=function(){a.review.$save(),a.close()},a.close=function(){b.close()}}]),angular.module("cfgUiApp").service("Review",["$resource",function(a){var b=window.config;return a(b.routes.review,null,{"new":{method:"GET",url:b.routes.reviewNew}})}]);